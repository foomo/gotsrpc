// Code generated by gotsrpc https://github.com/foomo/gotsrpc/v2  - DO NOT EDIT.

package service

import (
	io "io"
	http "net/http"
	time "time"

	gotsrpc "github.com/foomo/gotsrpc/v2"
)

const (
	HelloServiceGoTSRPCProxyContext     = "Context"
	HelloServiceGoTSRPCProxyGetUserInfo = "GetUserInfo"
	HelloServiceGoTSRPCProxySayHello    = "SayHello"
)

type HelloServiceGoTSRPCProxy struct {
	EndPoint string
	service  HelloService
}

func NewDefaultHelloServiceGoTSRPCProxy(service HelloService) *HelloServiceGoTSRPCProxy {
	return NewHelloServiceGoTSRPCProxy(service, "/hello")
}

func NewHelloServiceGoTSRPCProxy(service HelloService, endpoint string) *HelloServiceGoTSRPCProxy {
	return &HelloServiceGoTSRPCProxy{
		EndPoint: endpoint,
		service:  service,
	}
}

// ServeHTTP exposes your service
func (p *HelloServiceGoTSRPCProxy) ServeHTTP(w http.ResponseWriter, r *http.Request) {
	if r.Method == http.MethodOptions {
		return
	} else if r.Method != http.MethodPost {
		gotsrpc.ErrorMethodNotAllowed(w)
		return
	}
	defer io.Copy(io.Discard, r.Body) // Drain Request Body

	funcName := gotsrpc.GetCalledFunc(r, p.EndPoint)
	callStats, _ := gotsrpc.GetStatsForRequest(r)
	callStats.Func = funcName
	callStats.Package = "github.com/foomo/gotsrpc/v2/example/auth/service"
	callStats.Service = "HelloService"
	switch funcName {
	case HelloServiceGoTSRPCProxyContext:
		var (
			args []interface{}
			rets []interface{}
		)
		executionStart := time.Now()
		rw := gotsrpc.ResponseWriter{ResponseWriter: w}
		p.service.Context(&rw, r)
		callStats.Execution = time.Since(executionStart)
		if rw.Status() == http.StatusOK {
			rets = []interface{}{}
			if err := gotsrpc.Reply(rets, callStats, r, w); err != nil {
				gotsrpc.ErrorCouldNotReply(w)
				return
			}
		}
		gotsrpc.Monitor(w, r, args, rets, callStats)
		return
	case HelloServiceGoTSRPCProxyGetUserInfo:
		var (
			args []interface{}
			rets []interface{}
		)
		executionStart := time.Now()
		getUserInfoRet, getUserInfoRet_1 := p.service.GetUserInfo()
		callStats.Execution = time.Since(executionStart)
		rets = []interface{}{getUserInfoRet, getUserInfoRet_1}
		if err := gotsrpc.Reply(rets, callStats, r, w); err != nil {
			gotsrpc.ErrorCouldNotReply(w)
			return
		}
		gotsrpc.Monitor(w, r, args, rets, callStats)
		return
	case HelloServiceGoTSRPCProxySayHello:
		var (
			args []interface{}
			rets []interface{}
		)
		var (
			arg_req HelloRequest
		)
		args = []interface{}{&arg_req}
		if err := gotsrpc.LoadArgs(&args, callStats, r); err != nil {
			gotsrpc.ErrorCouldNotLoadArgs(w)
			return
		}
		executionStart := time.Now()
		sayHelloRet, sayHelloRet_1 := p.service.SayHello(arg_req)
		callStats.Execution = time.Since(executionStart)
		rets = []interface{}{sayHelloRet, sayHelloRet_1}
		if err := gotsrpc.Reply(rets, callStats, r, w); err != nil {
			gotsrpc.ErrorCouldNotReply(w)
			return
		}
		gotsrpc.Monitor(w, r, args, rets, callStats)
		return
	default:
		gotsrpc.ClearStats(r)
		gotsrpc.ErrorFuncNotFound(w)
	}
}

const (
	AuthServiceGoTSRPCProxyLogin         = "Login"
	AuthServiceGoTSRPCProxyLogout        = "Logout"
	AuthServiceGoTSRPCProxyValidateToken = "ValidateToken"
)

type AuthServiceGoTSRPCProxy struct {
	EndPoint string
	service  AuthService
}

func NewDefaultAuthServiceGoTSRPCProxy(service AuthService) *AuthServiceGoTSRPCProxy {
	return NewAuthServiceGoTSRPCProxy(service, "/auth")
}

func NewAuthServiceGoTSRPCProxy(service AuthService, endpoint string) *AuthServiceGoTSRPCProxy {
	return &AuthServiceGoTSRPCProxy{
		EndPoint: endpoint,
		service:  service,
	}
}

// ServeHTTP exposes your service
func (p *AuthServiceGoTSRPCProxy) ServeHTTP(w http.ResponseWriter, r *http.Request) {
	if r.Method == http.MethodOptions {
		return
	} else if r.Method != http.MethodPost {
		gotsrpc.ErrorMethodNotAllowed(w)
		return
	}
	defer io.Copy(io.Discard, r.Body) // Drain Request Body

	funcName := gotsrpc.GetCalledFunc(r, p.EndPoint)
	callStats, _ := gotsrpc.GetStatsForRequest(r)
	callStats.Func = funcName
	callStats.Package = "github.com/foomo/gotsrpc/v2/example/auth/service"
	callStats.Service = "AuthService"
	switch funcName {
	case AuthServiceGoTSRPCProxyLogin:
		var (
			args []interface{}
			rets []interface{}
		)
		var (
			arg_req LoginRequest
		)
		args = []interface{}{&arg_req}
		if err := gotsrpc.LoadArgs(&args, callStats, r); err != nil {
			gotsrpc.ErrorCouldNotLoadArgs(w)
			return
		}
		executionStart := time.Now()
		loginRet, loginRet_1 := p.service.Login(arg_req)
		callStats.Execution = time.Since(executionStart)
		rets = []interface{}{loginRet, loginRet_1}
		if err := gotsrpc.Reply(rets, callStats, r, w); err != nil {
			gotsrpc.ErrorCouldNotReply(w)
			return
		}
		gotsrpc.Monitor(w, r, args, rets, callStats)
		return
	case AuthServiceGoTSRPCProxyLogout:
		var (
			args []interface{}
			rets []interface{}
		)
		var (
			arg_token string
		)
		args = []interface{}{&arg_token}
		if err := gotsrpc.LoadArgs(&args, callStats, r); err != nil {
			gotsrpc.ErrorCouldNotLoadArgs(w)
			return
		}
		executionStart := time.Now()
		logoutRet := p.service.Logout(arg_token)
		callStats.Execution = time.Since(executionStart)
		rets = []interface{}{logoutRet}
		if err := gotsrpc.Reply(rets, callStats, r, w); err != nil {
			gotsrpc.ErrorCouldNotReply(w)
			return
		}
		gotsrpc.Monitor(w, r, args, rets, callStats)
		return
	case AuthServiceGoTSRPCProxyValidateToken:
		var (
			args []interface{}
			rets []interface{}
		)
		var (
			arg_token string
		)
		args = []interface{}{&arg_token}
		if err := gotsrpc.LoadArgs(&args, callStats, r); err != nil {
			gotsrpc.ErrorCouldNotLoadArgs(w)
			return
		}
		executionStart := time.Now()
		validateTokenRet, validateTokenRet_1 := p.service.ValidateToken(arg_token)
		callStats.Execution = time.Since(executionStart)
		rets = []interface{}{validateTokenRet, validateTokenRet_1}
		if err := gotsrpc.Reply(rets, callStats, r, w); err != nil {
			gotsrpc.ErrorCouldNotReply(w)
			return
		}
		gotsrpc.Monitor(w, r, args, rets, callStats)
		return
	default:
		gotsrpc.ClearStats(r)
		gotsrpc.ErrorFuncNotFound(w)
	}
}
